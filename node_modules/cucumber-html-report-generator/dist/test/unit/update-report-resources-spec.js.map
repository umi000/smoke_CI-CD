{"version":3,"file":"update-report-resources-spec.js","sourceRoot":"","sources":["../../../test/unit/update-report-resources-spec.ts"],"names":[],"mappings":"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","sourcesContent":["import * as chai from 'chai';\nimport * as dependencyModifycationFunctions from '../../src/scripts/dependency-modification-functions';\nimport * as path from 'path';\nimport { CommonFunctions } from 'index';\nimport type { Models } from 'index';\nimport chaiAsPromised from 'chai-as-promised';\nimport { simpleGit } from 'simple-git';\nchai.use( chaiAsPromised );\nconst { expect } = chai;\n\n\ndescribe( 'update-report-resources-spec', () => {\n  describe( 'Happy flows', () => {\n    it( 'should return the properties of a resource', async () => {\n      // Given\n      const resourcesDataFile = path.resolve( process.cwd(), './test/unit/data/update-report-resources/resources-data.json' );\n      const configurationData = await CommonFunctions.readJsonFile<Models.ResourceProperties[]>( resourcesDataFile );\n      const tempConfigurationData = await CommonFunctions.readJsonFile<Models.ResourceProperties[]>( resourcesDataFile );\n      const resourcesFolder = path.resolve( process.cwd(), './test/unit/data/update-report-resources/resources' );\n      const featureIndex = path.resolve( process.cwd(), './test/unit/data/update-report-resources/templates/feature-overview-index.tmpl' );\n      const featureIsndex = path.resolve( process.cwd(), './test/unit/data/update-report-resources/templates/features-overview-index.tmpl' );\n\n      // When\n      await dependencyModifycationFunctions.updateResources( resourcesDataFile, resourcesFolder, [ featureIsndex, featureIndex ] );\n\n      // Then\n      const updatedConfigurationData = await CommonFunctions.readJsonFile<Models.ResourceProperties[]>( resourcesDataFile );\n      expect( updatedConfigurationData ).to.be.not.equal( configurationData );\n      if ( updatedConfigurationData ) {\n        updatedConfigurationData.forEach( elementConf => {\n          elementConf.files.forEach( file => expect( CommonFunctions.exists( `${resourcesFolder}/${file.path.replace( 'resources/', '' )}` ) ).to.be.true\n          );\n        } );\n      }\n\n      if ( tempConfigurationData ) {\n        tempConfigurationData.forEach( elementConf => {\n          elementConf.files.forEach( file => expect( CommonFunctions.exists( `${resourcesFolder}/${file.path.replace( 'resources/', '' )}` ) ).to.be.false\n          );\n        } );\n      }\n\n      await dependencyModifycationFunctions.deleteOldDependencies( updatedConfigurationData?.[ 0 ]!, resourcesFolder );\n      await dependencyModifycationFunctions.deleteOldDependencies( updatedConfigurationData?.[ 1 ]!, resourcesFolder );\n\n      const updatedFiles = [\n        'test/unit/data/update-report-resources/resources/Chart.js-3.7.1/chart.min.js',\n        'test/unit/data/update-report-resources/resources/twitter-bootstrap-5.1.2/css/bootstrap.min.css',\n        'test/unit/data/update-report-resources/resources/twitter-bootstrap-5.1.2/js/bootstrap.min.js',\n        'test/unit/data/update-report-resources/templates/feature-overview-index.tmpl',\n        'test/unit/data/update-report-resources/templates/features-overview-index.tmpl',\n        'test/unit/data/update-report-resources/resources-data.json'\n      ];\n      updatedFiles.forEach( file => simpleGit().checkout( file ) );\n    } );\n  } );\n} );"]}